- name: Run through story with preconditions
  tags:
    - preconditions
    - simple
    - documentation
    - happy
  preconditions:
    files:
      example.story: |
        Create files:
          preconditions:
            content: things
          scenario:
            - Create file
      engine.py: |
        from hitchstory import BaseEngine, StorySchema
        from strictyaml import Str

        def output(contents):
            with open("output.txt", 'a') as handle:
                handle.write("{0}\n".format(contents))

        class Engine(BaseEngine):
            schema = StorySchema(
                preconditions={"content": Str(),},
            )

            def create_file(self):
                output(self.preconditions['content'])
  scenario:
    - Run command: |
        from hitchstory import StoryCollection
        from pathquery import pathq
        from engine import Engine

        StoryCollection(pathq(".").ext("story"), Engine()).one().play()
    - Output is: things
