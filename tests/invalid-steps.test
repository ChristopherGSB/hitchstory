- name: Invalid validator
  tags:
    - invalid-type
    - exception
  preconditions:
    files:
      example.story: |
        Create files:
          scenario:
            - Add product:
                name: Towel
                quantity: Three
  scenario:
    - Run command: |
        from hitchstory import StoryCollection, BaseEngine, validate
        from strictyaml import Int

        class Engine(BaseEngine):
            @validate(quantity=Int())
            def add_product(self, name, quantity):
                pass


        result = StoryCollection(".", Engine()).story("example.story", "Create files").play()
        output(result.in_color())
    - Output contains: YAMLValidationError


- name: Invalid type
  tags:
    - invalid-type
    - exception
  preconditions:
    files:
      example.story: |
        Create files:
          scenario:
            - Add product:
                name: Towel
                quantity: Three
  scenario:
    - Assert exception: 
        command: |
          from hitchstory import StoryCollection, BaseEngine, validate
          from strictyaml import Int

          class Engine(BaseEngine):
              @validate(not_an_argument=Int())
              def add_product(self, name, quantity):
                  pass


          result = StoryCollection(".", Engine()).story("example.story", "Create files").play()
          output(result.in_color())
        exception: StepContainsInvalidValidator
    #- Output contains: hitchstory.exceptions.StepContainsInvalidValidator



- name: Callable step not found
  tags:
    - not-callable
    - exception
  preconditions:
    files:
      example.story: |
        Create files:
          scenario:
            - Add product:
                name: Towel
                quantity: Three
  scenario:
    - Run command: |
        from hitchstory import StoryCollection, BaseEngine

        class Engine(BaseEngine):
            def set_up(self):
                self.add_product = 1

            def tear_down(self):
                pass

        result = StoryCollection(".", Engine()).story("example.story", "Create files").play()
        output(result.in_color())
    - Output contains: StepNotCallable


- name: Method not found
  tags:
    - not-found
    - exception
  preconditions:
    files:
      example.story: |
        Create files:
          scenario:
            - Add product:
                name: Towel
                quantity: Three
  scenario:
    - Run command: |
        from hitchstory import StoryCollection, BaseEngine

        class Engine(BaseEngine):
            def set_up(self):
                pass

            def tear_down(self):
                pass

        result = StoryCollection(".", Engine()).story("example.story", "Create files").play()
        output(result.in_color())
    - Output contains: StepNotFound
